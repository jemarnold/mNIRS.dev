<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit Kinetics — process_kinetics • mNIRS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Kinetics — process_kinetics"><meta name="description" content="Perform parametric curve fitting or non-parametric estimation of mNIRS kinetics
on vector data."><meta property="og:description" content="Perform parametric curve fitting or non-parametric estimation of mNIRS kinetics
on vector data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mNIRS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9010</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/processing-mNIRS-data.html">Processing Data with {mNIRS}</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jemarnold/mNIRS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit Kinetics</h1>
      <small class="dont-index">Source: <a href="https://github.com/jemarnold/mNIRS/blob/main/R/process_kinetics.R" class="external-link"><code>R/process_kinetics.R</code></a></small>
      <div class="d-none name"><code>process_kinetics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform parametric curve fitting or non-parametric estimation of mNIRS kinetics
on vector data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'monoexponential'</span></span>
<span><span class="fu">process_kinetics</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  window <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"monoexponential"</span>, <span class="st">"sigmoidal"</span>, <span class="st">"half_time"</span>, <span class="st">"peak_slope"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'sigmoidal'</span></span>
<span><span class="fu">process_kinetics</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  window <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"monoexponential"</span>, <span class="st">"sigmoidal"</span>, <span class="st">"half_time"</span>, <span class="st">"peak_slope"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'half_time'</span></span>
<span><span class="fu">process_kinetics</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  window <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"monoexponential"</span>, <span class="st">"sigmoidal"</span>, <span class="st">"half_time"</span>, <span class="st">"peak_slope"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'peak_slope'</span></span>
<span><span class="fu">process_kinetics</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  window <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"monoexponential"</span>, <span class="st">"sigmoidal"</span>, <span class="st">"half_time"</span>, <span class="st">"peak_slope"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A numeric vector of the response variable, or the name of the
variable within a dataframe.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An <em>optional</em> numeric vector of the predictor variable, or the name
of the variable within a dataframe. <em>Defaults</em> to using the index of
<code>x = seq_along(y)</code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>An <em>optional</em> dataframe containing the predictor and response
variables named in <code>x</code> and <code>y</code>. Names for <code>x</code> and <code>y</code> must be in quotations.</p></dd>


<dt id="arg-x-">x0<a class="anchor" aria-label="anchor" href="#arg-x-"></a></dt>
<dd><p>(<em>Default = 0</em>) A numeric scalar indicating the value of the predictor variable <code>x</code>
representing the start of the kinetics event.</p></dd>


<dt id="arg-window">window<a class="anchor" aria-label="anchor" href="#arg-window"></a></dt>
<dd><p>(<em>Default = 30</em>) A numeric scalar indicating the local window in units of
the predictor variable <code>x</code> after the kinetics extreme (peak or trough) value
to look for subsequent greater extremes. The kinetics model will be fit to the
data up to the first local extreme with no subsequent greater extremes within
the lesser of either the <code>window</code> or the limits of the data.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Indicates which model to evaluate the kinetics event
(see <em>Details</em> for method parametrisation).</p><dl><dt><code>method = "monoexponential"</code></dt>
<dd><p>A four-parameter monoexponential
association function in the form:
<code>ifelse(x &lt;= TD, A, A + (B - A) * (1 - exp((TD - x) / tau)))</code>.</p></dd>

<dt><code>method = "sigmoidal"</code></dt>
<dd><p>A four-parameter generalised logistic
(sigmoidal) function in the form:
<code>A + (B - A) / (1 + exp((xmid - x) / scal))</code>.</p></dd>

<dt><code>method = "half_time"</code></dt>
<dd><p>A non-parametric estimate of the time
to recover half of the total reoxygenation amplitude.</p></dd>

<dt><code>method = "peak_slope"</code></dt>
<dd><p>A non-parametric estimate of the time
to reach the peak rolling linear regression slope within a window
defined by <code>width</code>.</p></dd>


</dl></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical. <code>TRUE</code> (<em>default</em>) will return warnings and
messages which can be used for data error checking. <code>FALSE</code> will silence these
messages. Errors will always be returned.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments.</p><dl><dt><code>width</code></dt>
<dd><p>A numeric scalar defining the window width (in units of
the predictor variable <code>x</code>) for rolling slope calculations (only used
for <code>method =</code> <em><code>"peak_slope"</code></em>).</p></dd>

<dt><code>align = c(</code><em><code>"center", "left", "right"</code></em><code>)</code></dt>
<dd><p>Specifies the window
alignment of <code>width</code> as <em>"center"</em> (<em>the default</em>), <em>"left"</em>,
or <em>"right"</em>. Where <em>"left"</em> is <em>forward looking</em>, and <em>"right"</em>
is <em>backward looking</em> by the window <code>width</code> from the current
observation (only used for <code>method =</code> <em><code>"peak_slope"</code></em>).</p></dd>

<dt><em>fixed parameters</em></dt>
<dd><p>Parameters (coefficients) of the parametric
models (<em>"monoexponential"</em> and <em>"sigmoidal"</em>) can be defined
a priori and fixed, to exclude them from the model fitting
optimisation. e.g., <code>A = 10</code> will define the function
<code>SSmonoexp(x, A = 10, B, TD, tau)</code>.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>mNIRS.kinetics</code> with components <code>L$...</code>:</p>
<dl><dt><code>method</code></dt>
<dd><p>The kinetics method used.</p></dd>

<dt><code>model</code></dt>
<dd><p>The model object.</p></dd>

<dt><code>equation</code></dt>
<dd><p>The equation of the kinetics model used.</p></dd>

<dt><code>data</code></dt>
<dd><p>A dataframe of original and fitted model data.</p></dd>

<dt><code>fitted</code></dt>
<dd><p>A vector of fitted values returned by the model.</p></dd>

<dt><code>residuals</code></dt>
<dd><p>A vector of residuals between original and fitted
values returned by the model.</p></dd>

<dt><code>x0</code></dt>
<dd><p>The value of the predictor variable indicating the start of
kinetics.</p></dd>

<dt><code>coefs</code></dt>
<dd><p>A dataframe of model coefficients, including manually
fixed parameters.</p></dd>

<dt><code>diagnostics</code></dt>
<dd><p>A dataframe of model goodness-of-fit metrics
(<code>AIC</code>, <code>BIC</code>, <code>R2adj</code> <code>RMSE</code>, <code>MAE</code>, <code>MAPE</code>).</p></dd>

<dt><code>call</code></dt>
<dd><p>The model call.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>method %in% c("monoexponential", "sigmoidal")</code> use <a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls()</a>
for nonlinear (weighted) least-squares estimates.</p>
<p>Model Parameterisation</p>
<p>"monoexponential": A four-parameter monoexponential association function
in the form: <code>ifelse(x &lt;= TD, A, A + (B - A) * (1 - exp((TD - x) / tau)))</code>.</p><ul><li><p><code>A</code>: text</p></li>
<li><p><code>B</code>: text</p></li>
<li><p><code>TD</code>: text</p></li>
<li><p><code>tau</code>: text</p></li>
<li><p><code>MRT</code>: text</p></li>
</ul><p>"sigmoidal": A four-parameter generalised logistic (sigmoidal) function
in the form: <code>A + (B - A) / (1 + exp((xmid - x) / scal))</code>.</p><ul><li><p><code>A</code>: text</p></li>
<li><p><code>B</code>: text</p></li>
<li><p><code>xmid</code>: text</p></li>
<li><p><code>scal</code>: text</p></li>
</ul><p>"half_time": A non-parametric estimate of the time to recover half of
the total reoxygenation amplitude.</p><ul><li><p><code>A</code>: text</p></li>
<li><p><code>B</code>: text</p></li>
<li><p><code>half_value</code>: text</p></li>
</ul><p>"peak_slope": A non-parametric estimate of the time to reach the peak
rolling linear regression slope within a window defined by <code>width</code>.</p><ul><li><p><code>A</code>: text</p></li>
<li><p><code>B</code>: text</p></li>
<li><p><code>x_fitted</code>: text</p></li>
<li><p><code>peak_slope</code>: text</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code>, <code><a href="https://rdrr.io/r/stats/SSasymp.html" class="external-link">stats::SSasymp()</a></code>, <code><a href="https://rdrr.io/r/stats/SSfpl.html" class="external-link">stats::SSfpl()</a></code>,</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">13</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">60</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fl">10</span>; <span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">100</span>; <span class="va">TD</span> <span class="op">&lt;-</span> <span class="fl">5</span>; <span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">12</span></span></span>
<span class="r-in"><span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="monoexponential.html">monoexponential</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">A</span>, <span class="va">B</span>, <span class="va">TD</span>, <span class="va">tau</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## monoexponential kinetics ===============================</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">process_kinetics</span><span class="op">(</span><span class="va">y1</span>, <span class="va">x1</span>, method <span class="op">=</span> <span class="st">"monoexponential"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Monoexponential (Association) Nonlinear nls() Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model:        y ~ SSmonoexp(x, A, B, TD, tau)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   data:         data.frame(x = x, y = y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   equation:     y ~ A + (B - A) * (1 - exp((TD - x) / tau))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A      B    TD    tau    MRT MRT_fitted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 11.973 98.899 5.436 11.646 17.082     66.921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model Diagnostics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC     BIC R2adj  RMSE   MAE  MAPE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 180.958 188.875 0.994 2.600 2.046 5.465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## require(ggplot2)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, plot_coefs <span class="op">=</span> <span class="cn">TRUE</span>, plot_diagnostics <span class="op">=</span> <span class="cn">TRUE</span>, plot_residuals <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## sigmoidal kinetics ===============================</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">process_kinetics</span><span class="op">(</span><span class="va">y1</span>, <span class="va">x1</span>, method <span class="op">=</span> <span class="st">"sigmoidal"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sigmoidal (Generalised Logistic) Nonlinear nls() Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model:        y ~ SSfpl(x, A, B, xmid, scal)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   data:         data.frame(x = x, y = y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   equation:     y ~ A + (B - A) / (1 + exp((xmid - x) / scal))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       A      B  scal   xmid xmid_fitted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 7.929 95.468 5.178 13.919      51.699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model Diagnostics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC     BIC R2adj  RMSE   MAE  MAPE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 199.881 207.798 0.990 3.381 2.661 9.035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## require(ggplot2)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, plot_coefs <span class="op">=</span> <span class="cn">TRUE</span>, plot_diagnostics <span class="op">=</span> <span class="cn">TRUE</span>, plot_residuals <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## half recovery time ===============================</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">process_kinetics</span><span class="op">(</span><span class="va">y1</span>, <span class="va">x1</span>, method <span class="op">=</span> <span class="st">"half_time"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Non-parametric Half Response Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   data:         data.frame(x = x, y = y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   equation:     half_x ~ interp_x(y = A + (B - A) / 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A       B half_x half_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 11.663 100.752 16.000     56.207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## require(ggplot2)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, plot_coefs <span class="op">=</span> <span class="cn">TRUE</span>, plot_diagnostics <span class="op">=</span> <span class="cn">TRUE</span>, plot_residuals <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## peak slope ===============================</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">process_kinetics</span><span class="op">(</span><span class="va">y1</span>, <span class="va">x1</span>, method <span class="op">=</span> <span class="st">"peak_slope"</span>, width <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Peak Linear Regression Rolling Slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   data:         data.frame(x = x, y = y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   equation:     peak_slope ~ max(rolling_slope(y ~ x, width = 10))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   peak_slope_x peak_slope_fitted peak_slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        8.000            33.223      5.110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## require(ggplot2)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, plot_coefs <span class="op">=</span> <span class="cn">TRUE</span>, plot_diagnostics <span class="op">=</span> <span class="cn">TRUE</span>, plot_residuals <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jem Arnold.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

